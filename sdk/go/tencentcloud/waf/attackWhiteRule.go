// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package waf

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
	"github.com/tencentcloudstack/pulumi-tencentcloud/sdk/go/tencentcloud/internal"
)

// Provides a resource to create a WAF attack white rule
//
// ## Example Usage
//
// ### Using typeIds
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/tencentcloudstack/pulumi-tencentcloud/sdk/go/tencentcloud/waf"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := waf.NewAttackWhiteRule(ctx, "example", &waf.AttackWhiteRuleArgs{
//				Domain: pulumi.String("www.demo.com"),
//				Name:   pulumi.String("tf-example"),
//				Status: pulumi.Int(1),
//				Mode:   pulumi.Int(0),
//				Rules: waf.AttackWhiteRuleRuleArray{
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("IP"),
//						MatchMethod:  pulumi.String("ipmatch"),
//						MatchContent: pulumi.String("1.1.1.1"),
//					},
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("Referer"),
//						MatchMethod:  pulumi.String("eq"),
//						MatchContent: pulumi.String("referer content"),
//					},
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("URL"),
//						MatchMethod:  pulumi.String("contains"),
//						MatchContent: pulumi.String("/prefix"),
//					},
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("HTTP_METHOD"),
//						MatchMethod:  pulumi.String("neq"),
//						MatchContent: pulumi.String("POST"),
//					},
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("GET"),
//						MatchMethod:  pulumi.String("ncontains"),
//						MatchContent: pulumi.String("value"),
//						MatchParams:  pulumi.String("key"),
//					},
//				},
//				TypeIds: pulumi.StringArray{
//					pulumi.String("010000000"),
//					pulumi.String("020000000"),
//					pulumi.String("030000000"),
//					pulumi.String("040000000"),
//					pulumi.String("050000000"),
//					pulumi.String("060000000"),
//					pulumi.String("090000000"),
//					pulumi.String("110000000"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ### Using signatureIds
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/tencentcloudstack/pulumi-tencentcloud/sdk/go/tencentcloud/waf"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := waf.NewAttackWhiteRule(ctx, "example", &waf.AttackWhiteRuleArgs{
//				Domain: pulumi.String("www.demo.com"),
//				Name:   pulumi.String("tf-example"),
//				Status: pulumi.Int(0),
//				Mode:   pulumi.Int(1),
//				Rules: waf.AttackWhiteRuleRuleArray{
//					&waf.AttackWhiteRuleRuleArgs{
//						MatchField:   pulumi.String("IP"),
//						MatchMethod:  pulumi.String("ipmatch"),
//						MatchContent: pulumi.String("1.1.1.1"),
//					},
//				},
//				SignatureIds: pulumi.StringArray{
//					pulumi.String("60270036"),
//					pulumi.String("10000047"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// WAF attack white rule can be imported using the id, e.g.
//
// ```sh
// $ pulumi import tencentcloud:Waf/attackWhiteRule:AttackWhiteRule example www.demo.com#38562
// ```
type AttackWhiteRule struct {
	pulumi.CustomResourceState

	// Domain.
	Domain pulumi.StringOutput `pulumi:"domain"`
	// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
	Mode pulumi.IntOutput `pulumi:"mode"`
	// Rule name.
	Name pulumi.StringOutput `pulumi:"name"`
	// Rule ID.
	RuleId pulumi.IntOutput `pulumi:"ruleId"`
	// Rule list.
	Rules AttackWhiteRuleRuleArrayOutput `pulumi:"rules"`
	// Whitelist of rule IDs.
	SignatureIds pulumi.StringArrayOutput `pulumi:"signatureIds"`
	// Rule status.
	Status pulumi.IntOutput `pulumi:"status"`
	// The whitened category rule ID.
	TypeIds pulumi.StringArrayOutput `pulumi:"typeIds"`
}

// NewAttackWhiteRule registers a new resource with the given unique name, arguments, and options.
func NewAttackWhiteRule(ctx *pulumi.Context,
	name string, args *AttackWhiteRuleArgs, opts ...pulumi.ResourceOption) (*AttackWhiteRule, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Domain == nil {
		return nil, errors.New("invalid value for required argument 'Domain'")
	}
	if args.Rules == nil {
		return nil, errors.New("invalid value for required argument 'Rules'")
	}
	if args.Status == nil {
		return nil, errors.New("invalid value for required argument 'Status'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource AttackWhiteRule
	err := ctx.RegisterResource("tencentcloud:Waf/attackWhiteRule:AttackWhiteRule", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetAttackWhiteRule gets an existing AttackWhiteRule resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetAttackWhiteRule(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *AttackWhiteRuleState, opts ...pulumi.ResourceOption) (*AttackWhiteRule, error) {
	var resource AttackWhiteRule
	err := ctx.ReadResource("tencentcloud:Waf/attackWhiteRule:AttackWhiteRule", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering AttackWhiteRule resources.
type attackWhiteRuleState struct {
	// Domain.
	Domain *string `pulumi:"domain"`
	// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
	Mode *int `pulumi:"mode"`
	// Rule name.
	Name *string `pulumi:"name"`
	// Rule ID.
	RuleId *int `pulumi:"ruleId"`
	// Rule list.
	Rules []AttackWhiteRuleRule `pulumi:"rules"`
	// Whitelist of rule IDs.
	SignatureIds []string `pulumi:"signatureIds"`
	// Rule status.
	Status *int `pulumi:"status"`
	// The whitened category rule ID.
	TypeIds []string `pulumi:"typeIds"`
}

type AttackWhiteRuleState struct {
	// Domain.
	Domain pulumi.StringPtrInput
	// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
	Mode pulumi.IntPtrInput
	// Rule name.
	Name pulumi.StringPtrInput
	// Rule ID.
	RuleId pulumi.IntPtrInput
	// Rule list.
	Rules AttackWhiteRuleRuleArrayInput
	// Whitelist of rule IDs.
	SignatureIds pulumi.StringArrayInput
	// Rule status.
	Status pulumi.IntPtrInput
	// The whitened category rule ID.
	TypeIds pulumi.StringArrayInput
}

func (AttackWhiteRuleState) ElementType() reflect.Type {
	return reflect.TypeOf((*attackWhiteRuleState)(nil)).Elem()
}

type attackWhiteRuleArgs struct {
	// Domain.
	Domain string `pulumi:"domain"`
	// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
	Mode *int `pulumi:"mode"`
	// Rule name.
	Name *string `pulumi:"name"`
	// Rule list.
	Rules []AttackWhiteRuleRule `pulumi:"rules"`
	// Whitelist of rule IDs.
	SignatureIds []string `pulumi:"signatureIds"`
	// Rule status.
	Status int `pulumi:"status"`
	// The whitened category rule ID.
	TypeIds []string `pulumi:"typeIds"`
}

// The set of arguments for constructing a AttackWhiteRule resource.
type AttackWhiteRuleArgs struct {
	// Domain.
	Domain pulumi.StringInput
	// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
	Mode pulumi.IntPtrInput
	// Rule name.
	Name pulumi.StringPtrInput
	// Rule list.
	Rules AttackWhiteRuleRuleArrayInput
	// Whitelist of rule IDs.
	SignatureIds pulumi.StringArrayInput
	// Rule status.
	Status pulumi.IntInput
	// The whitened category rule ID.
	TypeIds pulumi.StringArrayInput
}

func (AttackWhiteRuleArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*attackWhiteRuleArgs)(nil)).Elem()
}

type AttackWhiteRuleInput interface {
	pulumi.Input

	ToAttackWhiteRuleOutput() AttackWhiteRuleOutput
	ToAttackWhiteRuleOutputWithContext(ctx context.Context) AttackWhiteRuleOutput
}

func (*AttackWhiteRule) ElementType() reflect.Type {
	return reflect.TypeOf((**AttackWhiteRule)(nil)).Elem()
}

func (i *AttackWhiteRule) ToAttackWhiteRuleOutput() AttackWhiteRuleOutput {
	return i.ToAttackWhiteRuleOutputWithContext(context.Background())
}

func (i *AttackWhiteRule) ToAttackWhiteRuleOutputWithContext(ctx context.Context) AttackWhiteRuleOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AttackWhiteRuleOutput)
}

// AttackWhiteRuleArrayInput is an input type that accepts AttackWhiteRuleArray and AttackWhiteRuleArrayOutput values.
// You can construct a concrete instance of `AttackWhiteRuleArrayInput` via:
//
//	AttackWhiteRuleArray{ AttackWhiteRuleArgs{...} }
type AttackWhiteRuleArrayInput interface {
	pulumi.Input

	ToAttackWhiteRuleArrayOutput() AttackWhiteRuleArrayOutput
	ToAttackWhiteRuleArrayOutputWithContext(context.Context) AttackWhiteRuleArrayOutput
}

type AttackWhiteRuleArray []AttackWhiteRuleInput

func (AttackWhiteRuleArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AttackWhiteRule)(nil)).Elem()
}

func (i AttackWhiteRuleArray) ToAttackWhiteRuleArrayOutput() AttackWhiteRuleArrayOutput {
	return i.ToAttackWhiteRuleArrayOutputWithContext(context.Background())
}

func (i AttackWhiteRuleArray) ToAttackWhiteRuleArrayOutputWithContext(ctx context.Context) AttackWhiteRuleArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AttackWhiteRuleArrayOutput)
}

// AttackWhiteRuleMapInput is an input type that accepts AttackWhiteRuleMap and AttackWhiteRuleMapOutput values.
// You can construct a concrete instance of `AttackWhiteRuleMapInput` via:
//
//	AttackWhiteRuleMap{ "key": AttackWhiteRuleArgs{...} }
type AttackWhiteRuleMapInput interface {
	pulumi.Input

	ToAttackWhiteRuleMapOutput() AttackWhiteRuleMapOutput
	ToAttackWhiteRuleMapOutputWithContext(context.Context) AttackWhiteRuleMapOutput
}

type AttackWhiteRuleMap map[string]AttackWhiteRuleInput

func (AttackWhiteRuleMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AttackWhiteRule)(nil)).Elem()
}

func (i AttackWhiteRuleMap) ToAttackWhiteRuleMapOutput() AttackWhiteRuleMapOutput {
	return i.ToAttackWhiteRuleMapOutputWithContext(context.Background())
}

func (i AttackWhiteRuleMap) ToAttackWhiteRuleMapOutputWithContext(ctx context.Context) AttackWhiteRuleMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(AttackWhiteRuleMapOutput)
}

type AttackWhiteRuleOutput struct{ *pulumi.OutputState }

func (AttackWhiteRuleOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**AttackWhiteRule)(nil)).Elem()
}

func (o AttackWhiteRuleOutput) ToAttackWhiteRuleOutput() AttackWhiteRuleOutput {
	return o
}

func (o AttackWhiteRuleOutput) ToAttackWhiteRuleOutputWithContext(ctx context.Context) AttackWhiteRuleOutput {
	return o
}

// Domain.
func (o AttackWhiteRuleOutput) Domain() pulumi.StringOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.StringOutput { return v.Domain }).(pulumi.StringOutput)
}

// 0: Whiten according to a specific rule ID, 1: Whiten according to the rule type.
func (o AttackWhiteRuleOutput) Mode() pulumi.IntOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.IntOutput { return v.Mode }).(pulumi.IntOutput)
}

// Rule name.
func (o AttackWhiteRuleOutput) Name() pulumi.StringOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.StringOutput { return v.Name }).(pulumi.StringOutput)
}

// Rule ID.
func (o AttackWhiteRuleOutput) RuleId() pulumi.IntOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.IntOutput { return v.RuleId }).(pulumi.IntOutput)
}

// Rule list.
func (o AttackWhiteRuleOutput) Rules() AttackWhiteRuleRuleArrayOutput {
	return o.ApplyT(func(v *AttackWhiteRule) AttackWhiteRuleRuleArrayOutput { return v.Rules }).(AttackWhiteRuleRuleArrayOutput)
}

// Whitelist of rule IDs.
func (o AttackWhiteRuleOutput) SignatureIds() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.StringArrayOutput { return v.SignatureIds }).(pulumi.StringArrayOutput)
}

// Rule status.
func (o AttackWhiteRuleOutput) Status() pulumi.IntOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.IntOutput { return v.Status }).(pulumi.IntOutput)
}

// The whitened category rule ID.
func (o AttackWhiteRuleOutput) TypeIds() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *AttackWhiteRule) pulumi.StringArrayOutput { return v.TypeIds }).(pulumi.StringArrayOutput)
}

type AttackWhiteRuleArrayOutput struct{ *pulumi.OutputState }

func (AttackWhiteRuleArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*AttackWhiteRule)(nil)).Elem()
}

func (o AttackWhiteRuleArrayOutput) ToAttackWhiteRuleArrayOutput() AttackWhiteRuleArrayOutput {
	return o
}

func (o AttackWhiteRuleArrayOutput) ToAttackWhiteRuleArrayOutputWithContext(ctx context.Context) AttackWhiteRuleArrayOutput {
	return o
}

func (o AttackWhiteRuleArrayOutput) Index(i pulumi.IntInput) AttackWhiteRuleOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *AttackWhiteRule {
		return vs[0].([]*AttackWhiteRule)[vs[1].(int)]
	}).(AttackWhiteRuleOutput)
}

type AttackWhiteRuleMapOutput struct{ *pulumi.OutputState }

func (AttackWhiteRuleMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*AttackWhiteRule)(nil)).Elem()
}

func (o AttackWhiteRuleMapOutput) ToAttackWhiteRuleMapOutput() AttackWhiteRuleMapOutput {
	return o
}

func (o AttackWhiteRuleMapOutput) ToAttackWhiteRuleMapOutputWithContext(ctx context.Context) AttackWhiteRuleMapOutput {
	return o
}

func (o AttackWhiteRuleMapOutput) MapIndex(k pulumi.StringInput) AttackWhiteRuleOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *AttackWhiteRule {
		return vs[0].(map[string]*AttackWhiteRule)[vs[1].(string)]
	}).(AttackWhiteRuleOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*AttackWhiteRuleInput)(nil)).Elem(), &AttackWhiteRule{})
	pulumi.RegisterInputType(reflect.TypeOf((*AttackWhiteRuleArrayInput)(nil)).Elem(), AttackWhiteRuleArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*AttackWhiteRuleMapInput)(nil)).Elem(), AttackWhiteRuleMap{})
	pulumi.RegisterOutputType(AttackWhiteRuleOutput{})
	pulumi.RegisterOutputType(AttackWhiteRuleArrayOutput{})
	pulumi.RegisterOutputType(AttackWhiteRuleMapOutput{})
}
