// Code generated by pulumi-language-go DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package igtm

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
	"github.com/tencentcloudstack/pulumi-tencentcloud/sdk/go/tencentcloud/internal"
)

// Provides a resource to create a IGTM strategy
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//	"github.com/tencentcloudstack/pulumi-tencentcloud/sdk/go/tencentcloud/igtm"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			example, err := igtm.NewInstance(ctx, "example", &igtm.InstanceArgs{
//				Domain:          pulumi.String("domain.com"),
//				AccessType:      pulumi.String("CUSTOM"),
//				GlobalTtl:       pulumi.Int(60),
//				PackageType:     pulumi.String("STANDARD"),
//				InstanceName:    pulumi.String("tf-example"),
//				AccessDomain:    pulumi.String("domain.com"),
//				AccessSubDomain: pulumi.String("subDomain.com"),
//				Remark:          pulumi.String("remark."),
//				ResourceId:      pulumi.String("ins-lnpnnwvwqmr"),
//			})
//			if err != nil {
//				return err
//			}
//			example1, err := igtm.NewAddressPool(ctx, "example1", &igtm.AddressPoolArgs{
//				PoolName:        pulumi.String("tf-example1"),
//				TrafficStrategy: pulumi.String("WEIGHT"),
//				AddressSets: igtm.AddressPoolAddressSetArray{
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("1.1.1.1"),
//						IsEnable: pulumi.String("ENABLED"),
//						Weight:   pulumi.Int(90),
//					},
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("2.2.2.2"),
//						IsEnable: pulumi.String("DISABLED"),
//						Weight:   pulumi.Int(50),
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			example2, err := igtm.NewAddressPool(ctx, "example2", &igtm.AddressPoolArgs{
//				PoolName:        pulumi.String("tf-example2"),
//				TrafficStrategy: pulumi.String("WEIGHT"),
//				AddressSets: igtm.AddressPoolAddressSetArray{
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("3.3.3.3"),
//						IsEnable: pulumi.String("ENABLED"),
//						Weight:   pulumi.Int(90),
//					},
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("4.4.4.4"),
//						IsEnable: pulumi.String("DISABLED"),
//						Weight:   pulumi.Int(50),
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			example3, err := igtm.NewAddressPool(ctx, "example3", &igtm.AddressPoolArgs{
//				PoolName:        pulumi.String("tf-example3"),
//				TrafficStrategy: pulumi.String("WEIGHT"),
//				AddressSets: igtm.AddressPoolAddressSetArray{
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("5.5.5.5"),
//						IsEnable: pulumi.String("ENABLED"),
//						Weight:   pulumi.Int(90),
//					},
//					&igtm.AddressPoolAddressSetArgs{
//						Addr:     pulumi.String("6.6.6.6"),
//						IsEnable: pulumi.String("DISABLED"),
//						Weight:   pulumi.Int(50),
//					},
//				},
//			})
//			if err != nil {
//				return err
//			}
//			_, err = igtm.NewStrategy(ctx, "example", &igtm.StrategyArgs{
//				InstanceId:   example.ID(),
//				StrategyName: pulumi.String("tf-example"),
//				Sources: igtm.StrategySourceArray{
//					&igtm.StrategySourceArgs{
//						DnsLineId: pulumi.Int(1),
//						Name:      pulumi.String("默认"),
//					},
//					&igtm.StrategySourceArgs{
//						DnsLineId: pulumi.Int(858),
//						Name:      pulumi.String("电信"),
//					},
//					&igtm.StrategySourceArgs{
//						DnsLineId: pulumi.Int(859),
//						Name:      pulumi.String("联通"),
//					},
//					&igtm.StrategySourceArgs{
//						DnsLineId: pulumi.Int(860),
//						Name:      pulumi.String("移动"),
//					},
//				},
//				MainAddressPoolSets: igtm.StrategyMainAddressPoolSetArray{
//					&igtm.StrategyMainAddressPoolSetArgs{
//						AddressPools: igtm.StrategyMainAddressPoolSetAddressPoolArray{
//							&igtm.StrategyMainAddressPoolSetAddressPoolArgs{
//								PoolId: example1.PoolId,
//								Weight: pulumi.Int(90),
//							},
//							&igtm.StrategyMainAddressPoolSetAddressPoolArgs{
//								PoolId: example2.PoolId,
//								Weight: pulumi.Int(80),
//							},
//						},
//						MinSurviveNum:   pulumi.Int(1),
//						TrafficStrategy: pulumi.String("WEIGHT"),
//					},
//				},
//				FallbackAddressPoolSets: igtm.StrategyFallbackAddressPoolSetArray{
//					&igtm.StrategyFallbackAddressPoolSetArgs{
//						AddressPools: igtm.StrategyFallbackAddressPoolSetAddressPoolArray{
//							&igtm.StrategyFallbackAddressPoolSetAddressPoolArgs{
//								PoolId: example3.PoolId,
//							},
//						},
//					},
//				},
//				KeepDomainRecords: pulumi.String("DISABLED"),
//				SwitchPoolType:    pulumi.String("AUTO"),
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// IGTM strategy can be imported using the instanceId#strategyId, e.g.
//
// ```sh
// $ pulumi import tencentcloud:Igtm/strategy:Strategy igtm_strategy gtm-uukztqtoaru#7556
// ```
type Strategy struct {
	pulumi.CustomResourceState

	// Fallback address pool set, only one level allowed and address pool count must be 1.
	FallbackAddressPoolSets StrategyFallbackAddressPoolSetArrayOutput `pulumi:"fallbackAddressPoolSets"`
	// Instance ID.
	InstanceId pulumi.StringOutput `pulumi:"instanceId"`
	// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
	KeepDomainRecords pulumi.StringPtrOutput `pulumi:"keepDomainRecords"`
	// Main address pool set, up to four levels allowed.
	MainAddressPoolSets StrategyMainAddressPoolSetArrayOutput `pulumi:"mainAddressPoolSets"`
	// Resolution lines.
	Sources StrategySourceArrayOutput `pulumi:"sources"`
	// Strategy ID.
	StrategyId pulumi.IntOutput `pulumi:"strategyId"`
	// Strategy name, cannot be duplicated.
	StrategyName pulumi.StringOutput `pulumi:"strategyName"`
	// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
	SwitchPoolType pulumi.StringPtrOutput `pulumi:"switchPoolType"`
}

// NewStrategy registers a new resource with the given unique name, arguments, and options.
func NewStrategy(ctx *pulumi.Context,
	name string, args *StrategyArgs, opts ...pulumi.ResourceOption) (*Strategy, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.FallbackAddressPoolSets == nil {
		return nil, errors.New("invalid value for required argument 'FallbackAddressPoolSets'")
	}
	if args.InstanceId == nil {
		return nil, errors.New("invalid value for required argument 'InstanceId'")
	}
	if args.MainAddressPoolSets == nil {
		return nil, errors.New("invalid value for required argument 'MainAddressPoolSets'")
	}
	if args.Sources == nil {
		return nil, errors.New("invalid value for required argument 'Sources'")
	}
	if args.StrategyName == nil {
		return nil, errors.New("invalid value for required argument 'StrategyName'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource Strategy
	err := ctx.RegisterResource("tencentcloud:Igtm/strategy:Strategy", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetStrategy gets an existing Strategy resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetStrategy(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *StrategyState, opts ...pulumi.ResourceOption) (*Strategy, error) {
	var resource Strategy
	err := ctx.ReadResource("tencentcloud:Igtm/strategy:Strategy", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering Strategy resources.
type strategyState struct {
	// Fallback address pool set, only one level allowed and address pool count must be 1.
	FallbackAddressPoolSets []StrategyFallbackAddressPoolSet `pulumi:"fallbackAddressPoolSets"`
	// Instance ID.
	InstanceId *string `pulumi:"instanceId"`
	// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
	KeepDomainRecords *string `pulumi:"keepDomainRecords"`
	// Main address pool set, up to four levels allowed.
	MainAddressPoolSets []StrategyMainAddressPoolSet `pulumi:"mainAddressPoolSets"`
	// Resolution lines.
	Sources []StrategySource `pulumi:"sources"`
	// Strategy ID.
	StrategyId *int `pulumi:"strategyId"`
	// Strategy name, cannot be duplicated.
	StrategyName *string `pulumi:"strategyName"`
	// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
	SwitchPoolType *string `pulumi:"switchPoolType"`
}

type StrategyState struct {
	// Fallback address pool set, only one level allowed and address pool count must be 1.
	FallbackAddressPoolSets StrategyFallbackAddressPoolSetArrayInput
	// Instance ID.
	InstanceId pulumi.StringPtrInput
	// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
	KeepDomainRecords pulumi.StringPtrInput
	// Main address pool set, up to four levels allowed.
	MainAddressPoolSets StrategyMainAddressPoolSetArrayInput
	// Resolution lines.
	Sources StrategySourceArrayInput
	// Strategy ID.
	StrategyId pulumi.IntPtrInput
	// Strategy name, cannot be duplicated.
	StrategyName pulumi.StringPtrInput
	// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
	SwitchPoolType pulumi.StringPtrInput
}

func (StrategyState) ElementType() reflect.Type {
	return reflect.TypeOf((*strategyState)(nil)).Elem()
}

type strategyArgs struct {
	// Fallback address pool set, only one level allowed and address pool count must be 1.
	FallbackAddressPoolSets []StrategyFallbackAddressPoolSet `pulumi:"fallbackAddressPoolSets"`
	// Instance ID.
	InstanceId string `pulumi:"instanceId"`
	// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
	KeepDomainRecords *string `pulumi:"keepDomainRecords"`
	// Main address pool set, up to four levels allowed.
	MainAddressPoolSets []StrategyMainAddressPoolSet `pulumi:"mainAddressPoolSets"`
	// Resolution lines.
	Sources []StrategySource `pulumi:"sources"`
	// Strategy name, cannot be duplicated.
	StrategyName string `pulumi:"strategyName"`
	// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
	SwitchPoolType *string `pulumi:"switchPoolType"`
}

// The set of arguments for constructing a Strategy resource.
type StrategyArgs struct {
	// Fallback address pool set, only one level allowed and address pool count must be 1.
	FallbackAddressPoolSets StrategyFallbackAddressPoolSetArrayInput
	// Instance ID.
	InstanceId pulumi.StringInput
	// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
	KeepDomainRecords pulumi.StringPtrInput
	// Main address pool set, up to four levels allowed.
	MainAddressPoolSets StrategyMainAddressPoolSetArrayInput
	// Resolution lines.
	Sources StrategySourceArrayInput
	// Strategy name, cannot be duplicated.
	StrategyName pulumi.StringInput
	// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
	SwitchPoolType pulumi.StringPtrInput
}

func (StrategyArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*strategyArgs)(nil)).Elem()
}

type StrategyInput interface {
	pulumi.Input

	ToStrategyOutput() StrategyOutput
	ToStrategyOutputWithContext(ctx context.Context) StrategyOutput
}

func (*Strategy) ElementType() reflect.Type {
	return reflect.TypeOf((**Strategy)(nil)).Elem()
}

func (i *Strategy) ToStrategyOutput() StrategyOutput {
	return i.ToStrategyOutputWithContext(context.Background())
}

func (i *Strategy) ToStrategyOutputWithContext(ctx context.Context) StrategyOutput {
	return pulumi.ToOutputWithContext(ctx, i).(StrategyOutput)
}

// StrategyArrayInput is an input type that accepts StrategyArray and StrategyArrayOutput values.
// You can construct a concrete instance of `StrategyArrayInput` via:
//
//	StrategyArray{ StrategyArgs{...} }
type StrategyArrayInput interface {
	pulumi.Input

	ToStrategyArrayOutput() StrategyArrayOutput
	ToStrategyArrayOutputWithContext(context.Context) StrategyArrayOutput
}

type StrategyArray []StrategyInput

func (StrategyArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Strategy)(nil)).Elem()
}

func (i StrategyArray) ToStrategyArrayOutput() StrategyArrayOutput {
	return i.ToStrategyArrayOutputWithContext(context.Background())
}

func (i StrategyArray) ToStrategyArrayOutputWithContext(ctx context.Context) StrategyArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(StrategyArrayOutput)
}

// StrategyMapInput is an input type that accepts StrategyMap and StrategyMapOutput values.
// You can construct a concrete instance of `StrategyMapInput` via:
//
//	StrategyMap{ "key": StrategyArgs{...} }
type StrategyMapInput interface {
	pulumi.Input

	ToStrategyMapOutput() StrategyMapOutput
	ToStrategyMapOutputWithContext(context.Context) StrategyMapOutput
}

type StrategyMap map[string]StrategyInput

func (StrategyMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Strategy)(nil)).Elem()
}

func (i StrategyMap) ToStrategyMapOutput() StrategyMapOutput {
	return i.ToStrategyMapOutputWithContext(context.Background())
}

func (i StrategyMap) ToStrategyMapOutputWithContext(ctx context.Context) StrategyMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(StrategyMapOutput)
}

type StrategyOutput struct{ *pulumi.OutputState }

func (StrategyOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**Strategy)(nil)).Elem()
}

func (o StrategyOutput) ToStrategyOutput() StrategyOutput {
	return o
}

func (o StrategyOutput) ToStrategyOutputWithContext(ctx context.Context) StrategyOutput {
	return o
}

// Fallback address pool set, only one level allowed and address pool count must be 1.
func (o StrategyOutput) FallbackAddressPoolSets() StrategyFallbackAddressPoolSetArrayOutput {
	return o.ApplyT(func(v *Strategy) StrategyFallbackAddressPoolSetArrayOutput { return v.FallbackAddressPoolSets }).(StrategyFallbackAddressPoolSetArrayOutput)
}

// Instance ID.
func (o StrategyOutput) InstanceId() pulumi.StringOutput {
	return o.ApplyT(func(v *Strategy) pulumi.StringOutput { return v.InstanceId }).(pulumi.StringOutput)
}

// Whether to enable policy forced retention of default lines disabled, enabled, default is disabled and only one policy can be enabled.
func (o StrategyOutput) KeepDomainRecords() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Strategy) pulumi.StringPtrOutput { return v.KeepDomainRecords }).(pulumi.StringPtrOutput)
}

// Main address pool set, up to four levels allowed.
func (o StrategyOutput) MainAddressPoolSets() StrategyMainAddressPoolSetArrayOutput {
	return o.ApplyT(func(v *Strategy) StrategyMainAddressPoolSetArrayOutput { return v.MainAddressPoolSets }).(StrategyMainAddressPoolSetArrayOutput)
}

// Resolution lines.
func (o StrategyOutput) Sources() StrategySourceArrayOutput {
	return o.ApplyT(func(v *Strategy) StrategySourceArrayOutput { return v.Sources }).(StrategySourceArrayOutput)
}

// Strategy ID.
func (o StrategyOutput) StrategyId() pulumi.IntOutput {
	return o.ApplyT(func(v *Strategy) pulumi.IntOutput { return v.StrategyId }).(pulumi.IntOutput)
}

// Strategy name, cannot be duplicated.
func (o StrategyOutput) StrategyName() pulumi.StringOutput {
	return o.ApplyT(func(v *Strategy) pulumi.StringOutput { return v.StrategyName }).(pulumi.StringOutput)
}

// Policy scheduling mode: AUTO default switching; STOP only pause without switching.
func (o StrategyOutput) SwitchPoolType() pulumi.StringPtrOutput {
	return o.ApplyT(func(v *Strategy) pulumi.StringPtrOutput { return v.SwitchPoolType }).(pulumi.StringPtrOutput)
}

type StrategyArrayOutput struct{ *pulumi.OutputState }

func (StrategyArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*Strategy)(nil)).Elem()
}

func (o StrategyArrayOutput) ToStrategyArrayOutput() StrategyArrayOutput {
	return o
}

func (o StrategyArrayOutput) ToStrategyArrayOutputWithContext(ctx context.Context) StrategyArrayOutput {
	return o
}

func (o StrategyArrayOutput) Index(i pulumi.IntInput) StrategyOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *Strategy {
		return vs[0].([]*Strategy)[vs[1].(int)]
	}).(StrategyOutput)
}

type StrategyMapOutput struct{ *pulumi.OutputState }

func (StrategyMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*Strategy)(nil)).Elem()
}

func (o StrategyMapOutput) ToStrategyMapOutput() StrategyMapOutput {
	return o
}

func (o StrategyMapOutput) ToStrategyMapOutputWithContext(ctx context.Context) StrategyMapOutput {
	return o
}

func (o StrategyMapOutput) MapIndex(k pulumi.StringInput) StrategyOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *Strategy {
		return vs[0].(map[string]*Strategy)[vs[1].(string)]
	}).(StrategyOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*StrategyInput)(nil)).Elem(), &Strategy{})
	pulumi.RegisterInputType(reflect.TypeOf((*StrategyArrayInput)(nil)).Elem(), StrategyArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*StrategyMapInput)(nil)).Elem(), StrategyMap{})
	pulumi.RegisterOutputType(StrategyOutput{})
	pulumi.RegisterOutputType(StrategyArrayOutput{})
	pulumi.RegisterOutputType(StrategyMapOutput{})
}
