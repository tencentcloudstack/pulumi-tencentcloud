// *** WARNING: this file was generated by pulumi-language-dotnet. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;
using Pulumi;

namespace TencentCloudIAC.PulumiPackage.Tencentcloud.Waf
{
    /// <summary>
    /// Provides a resource to create a WAF cc
    /// 
    /// ## Example Usage
    /// 
    /// ### If advance is 0(IP model)
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using System.Text.Json;
    /// using Pulumi;
    /// using Tencentcloud = TencentCloudIAC.PulumiPackage.Tencentcloud;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var example = new Tencentcloud.Waf.Cc("example", new()
    ///     {
    ///         Domain = "www.demo.com",
    ///         Name = "tf-example",
    ///         Status = 1,
    ///         Advance = "0",
    ///         Limit = "60",
    ///         Interval = "60",
    ///         Url = "/cc_demo",
    ///         MatchFunc = 0,
    ///         ActionType = "22",
    ///         Priority = 50,
    ///         ValidTime = 600,
    ///         Edition = "sparta-waf",
    ///         Type = 1,
    ///         LogicalOp = "and",
    ///         OptionsArr = JsonSerializer.Serialize(new[]
    ///         {
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "URL",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "=cHJlZml4",
    ///                 },
    ///                 ["match"] = "2",
    ///                 ["encodeflag"] = true,
    ///             },
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "Method",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "=POST",
    ///                 },
    ///                 ["match"] = "0",
    ///                 ["encodeflag"] = false,
    ///             },
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "Post",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "S2V5=VmFsdWU",
    ///                 },
    ///                 ["match"] = "0",
    ///                 ["encodeflag"] = true,
    ///             },
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "Referer",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "=",
    ///                 },
    ///                 ["match"] = "12",
    ///                 ["encodeflag"] = true,
    ///             },
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "Cookie",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "S2V5=VmFsdWU",
    ///                 },
    ///                 ["match"] = "3",
    ///                 ["encodeflag"] = true,
    ///             },
    ///             new Dictionary&lt;string, object?&gt;
    ///             {
    ///                 ["key"] = "IPLocation",
    ///                 ["args"] = new[]
    ///                 {
    ///                     "=eyJMYW5nIjoiY24iLCJBcmVhcyI6W3siQ291bnRyeSI6IuWbveWkliJ9XX0",
    ///                 },
    ///                 ["match"] = "13",
    ///                 ["encodeflag"] = true,
    ///             },
    ///         }),
    ///     });
    /// 
    /// });
    /// ```
    /// 
    /// ### If advance is 1(SESSION model)
    /// 
    /// ```csharp
    /// using System.Collections.Generic;
    /// using System.Linq;
    /// using Pulumi;
    /// using Tencentcloud = TencentCloudIAC.PulumiPackage.Tencentcloud;
    /// 
    /// return await Deployment.RunAsync(() =&gt; 
    /// {
    ///     var example = new Tencentcloud.Waf.Cc("example", new()
    ///     {
    ///         Domain = "news.bots.icu",
    ///         Name = "tf-example",
    ///         Status = 1,
    ///         Advance = "1",
    ///         Limit = "60",
    ///         Interval = "60",
    ///         Url = "/cc_demo",
    ///         MatchFunc = 0,
    ///         ActionType = "22",
    ///         Priority = 50,
    ///         ValidTime = 600,
    ///         Edition = "sparta-waf",
    ///         Type = 1,
    ///         SessionApplieds = new[]
    ///         {
    ///             0,
    ///         },
    ///         LimitMethod = "only_limit",
    ///         LogicalOp = "or",
    ///         CelRule = "(has(request.url) &amp;&amp; request.url.startsWith('/prefix')) &amp;&amp; (has(request.method) &amp;&amp; request.method == 'POST')",
    ///     });
    /// 
    /// });
    /// ```
    /// </summary>
    [TencentcloudResourceType("tencentcloud:Waf/cc:Cc")]
    public partial class Cc : global::Pulumi.CustomResource
    {
        /// <summary>
        /// Rule Action, 20 means observation, 21 means human-machine identification, 22 means interception, 23 means precise interception, 26 means precise human-machine identification, and 27 means JS verification.
        /// </summary>
        [Output("actionType")]
        public Output<string> ActionType { get; private set; } = null!;

        /// <summary>
        /// Advanced mode (whether to use session detection). 0(disabled) 1(enabled).
        /// </summary>
        [Output("advance")]
        public Output<string> Advance { get; private set; } = null!;

        /// <summary>
        /// Cel expression.
        /// </summary>
        [Output("celRule")]
        public Output<string?> CelRule { get; private set; } = null!;

        /// <summary>
        /// Domain.
        /// </summary>
        [Output("domain")]
        public Output<string> Domain { get; private set; } = null!;

        /// <summary>
        /// WAF edition. clb-waf means clb-waf, sparta-waf means saas-waf.
        /// </summary>
        [Output("edition")]
        public Output<string> Edition { get; private set; } = null!;

        /// <summary>
        /// Event ID.
        /// </summary>
        [Output("eventId")]
        public Output<string?> EventId { get; private set; } = null!;

        /// <summary>
        /// CC detection cycle.
        /// </summary>
        [Output("interval")]
        public Output<string> Interval { get; private set; } = null!;

        /// <summary>
        /// CC detection threshold.
        /// </summary>
        [Output("limit")]
        public Output<string> Limit { get; private set; } = null!;

        /// <summary>
        /// Frequency limiting method.
        /// </summary>
        [Output("limitMethod")]
        public Output<string> LimitMethod { get; private set; } = null!;

        /// <summary>
        /// Logical operator of configuration mode, and/or.
        /// </summary>
        [Output("logicalOp")]
        public Output<string> LogicalOp { get; private set; } = null!;

        /// <summary>
        /// Match method, 0(equal), 1(prefix), 2(contains), 3(not equal), 6(suffix), 7(not contains).
        /// </summary>
        [Output("matchFunc")]
        public Output<int> MatchFunc { get; private set; } = null!;

        /// <summary>
        /// Rule Name.
        /// </summary>
        [Output("name")]
        public Output<string> Name { get; private set; } = null!;

        /// <summary>
        /// CC matching conditions JSON serialized string, example: [{"key":"Method","args":["=R0VU"],"match":"0","encodeflag":true}] 
        /// 
        /// Available key values: Method, Post, Referer, Cookie, User-Agent, CustomHeader, CaptchaRisk, CaptchaDeviceRisk, CaptchaScore
        /// 
        /// Available match values:
        /// - When Key is Method: 0 (equal to), 3 (not equal to)
        /// - When Key is Post: 0 (equal to), 3 (not equal to)
        /// - When Key is Cookie: 0 (equal to), 2 (contains), 3 (not equal to), 7 (does not contain)
        /// - When Key is Referer: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is Cookie: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is User-Agent: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is CustomHeader: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is IPLocation: 13 (belongs to), 14 (does not belong to)
        /// - When Key is CaptchaRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaDeviceRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaScore: 15 (numerically equal to), 16 (numerically not equal to), 17 (numerically greater than), 18 (numerically less than), 19 (numerically greater than or equal to), 20 (numerically less than or equal to), 12 (exists), 5 (does not exist)
        /// 
        /// The args parameter represents matching content and requires encodeflag to be set to true. When Key is Post, Cookie, or CustomHeader, use equals sign = to concatenate Key and Value separately, and encode both with Base64, similar to YWJj=YWJj. When Key is Referer or User-Agent, use equals sign = to concatenate Value, similar to =YWJj.
        /// </summary>
        [Output("optionsArr")]
        public Output<string?> OptionsArr { get; private set; } = null!;

        /// <summary>
        /// Rule Priority.
        /// </summary>
        [Output("priority")]
        public Output<int> Priority { get; private set; } = null!;

        /// <summary>
        /// Rule ID.
        /// </summary>
        [Output("ruleId")]
        public Output<string> RuleId { get; private set; } = null!;

        /// <summary>
        /// Session ID that needs to be enabled for the rule.
        /// </summary>
        [Output("sessionApplieds")]
        public Output<ImmutableArray<int>> SessionApplieds { get; private set; } = null!;

        /// <summary>
        /// Rule Status, 0 rule close, 1 rule open.
        /// </summary>
        [Output("status")]
        public Output<int> Status { get; private set; } = null!;

        /// <summary>
        /// Operate Type.
        /// </summary>
        [Output("type")]
        public Output<int?> Type { get; private set; } = null!;

        /// <summary>
        /// Detection URL.
        /// </summary>
        [Output("url")]
        public Output<string> Url { get; private set; } = null!;

        /// <summary>
        /// Action ValidTime, minute unit. Min: 60, Max: 604800.
        /// </summary>
        [Output("validTime")]
        public Output<int> ValidTime { get; private set; } = null!;


        /// <summary>
        /// Create a Cc resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public Cc(string name, CcArgs args, CustomResourceOptions? options = null)
            : base("tencentcloud:Waf/cc:Cc", name, args ?? new CcArgs(), MakeResourceOptions(options, ""))
        {
        }

        private Cc(string name, Input<string> id, CcState? state = null, CustomResourceOptions? options = null)
            : base("tencentcloud:Waf/cc:Cc", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
                PluginDownloadURL = "github://api.github.com/tencentcloudstack",
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing Cc resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static Cc Get(string name, Input<string> id, CcState? state = null, CustomResourceOptions? options = null)
        {
            return new Cc(name, id, state, options);
        }
    }

    public sealed class CcArgs : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Rule Action, 20 means observation, 21 means human-machine identification, 22 means interception, 23 means precise interception, 26 means precise human-machine identification, and 27 means JS verification.
        /// </summary>
        [Input("actionType", required: true)]
        public Input<string> ActionType { get; set; } = null!;

        /// <summary>
        /// Advanced mode (whether to use session detection). 0(disabled) 1(enabled).
        /// </summary>
        [Input("advance", required: true)]
        public Input<string> Advance { get; set; } = null!;

        /// <summary>
        /// Cel expression.
        /// </summary>
        [Input("celRule")]
        public Input<string>? CelRule { get; set; }

        /// <summary>
        /// Domain.
        /// </summary>
        [Input("domain", required: true)]
        public Input<string> Domain { get; set; } = null!;

        /// <summary>
        /// WAF edition. clb-waf means clb-waf, sparta-waf means saas-waf.
        /// </summary>
        [Input("edition", required: true)]
        public Input<string> Edition { get; set; } = null!;

        /// <summary>
        /// Event ID.
        /// </summary>
        [Input("eventId")]
        public Input<string>? EventId { get; set; }

        /// <summary>
        /// CC detection cycle.
        /// </summary>
        [Input("interval", required: true)]
        public Input<string> Interval { get; set; } = null!;

        /// <summary>
        /// CC detection threshold.
        /// </summary>
        [Input("limit", required: true)]
        public Input<string> Limit { get; set; } = null!;

        /// <summary>
        /// Frequency limiting method.
        /// </summary>
        [Input("limitMethod")]
        public Input<string>? LimitMethod { get; set; }

        /// <summary>
        /// Logical operator of configuration mode, and/or.
        /// </summary>
        [Input("logicalOp")]
        public Input<string>? LogicalOp { get; set; }

        /// <summary>
        /// Match method, 0(equal), 1(prefix), 2(contains), 3(not equal), 6(suffix), 7(not contains).
        /// </summary>
        [Input("matchFunc", required: true)]
        public Input<int> MatchFunc { get; set; } = null!;

        /// <summary>
        /// Rule Name.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// CC matching conditions JSON serialized string, example: [{"key":"Method","args":["=R0VU"],"match":"0","encodeflag":true}] 
        /// 
        /// Available key values: Method, Post, Referer, Cookie, User-Agent, CustomHeader, CaptchaRisk, CaptchaDeviceRisk, CaptchaScore
        /// 
        /// Available match values:
        /// - When Key is Method: 0 (equal to), 3 (not equal to)
        /// - When Key is Post: 0 (equal to), 3 (not equal to)
        /// - When Key is Cookie: 0 (equal to), 2 (contains), 3 (not equal to), 7 (does not contain)
        /// - When Key is Referer: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is Cookie: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is User-Agent: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is CustomHeader: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is IPLocation: 13 (belongs to), 14 (does not belong to)
        /// - When Key is CaptchaRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaDeviceRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaScore: 15 (numerically equal to), 16 (numerically not equal to), 17 (numerically greater than), 18 (numerically less than), 19 (numerically greater than or equal to), 20 (numerically less than or equal to), 12 (exists), 5 (does not exist)
        /// 
        /// The args parameter represents matching content and requires encodeflag to be set to true. When Key is Post, Cookie, or CustomHeader, use equals sign = to concatenate Key and Value separately, and encode both with Base64, similar to YWJj=YWJj. When Key is Referer or User-Agent, use equals sign = to concatenate Value, similar to =YWJj.
        /// </summary>
        [Input("optionsArr")]
        public Input<string>? OptionsArr { get; set; }

        /// <summary>
        /// Rule Priority.
        /// </summary>
        [Input("priority", required: true)]
        public Input<int> Priority { get; set; } = null!;

        [Input("sessionApplieds")]
        private InputList<int>? _sessionApplieds;

        /// <summary>
        /// Session ID that needs to be enabled for the rule.
        /// </summary>
        public InputList<int> SessionApplieds
        {
            get => _sessionApplieds ?? (_sessionApplieds = new InputList<int>());
            set => _sessionApplieds = value;
        }

        /// <summary>
        /// Rule Status, 0 rule close, 1 rule open.
        /// </summary>
        [Input("status", required: true)]
        public Input<int> Status { get; set; } = null!;

        /// <summary>
        /// Operate Type.
        /// </summary>
        [Input("type")]
        public Input<int>? Type { get; set; }

        /// <summary>
        /// Detection URL.
        /// </summary>
        [Input("url", required: true)]
        public Input<string> Url { get; set; } = null!;

        /// <summary>
        /// Action ValidTime, minute unit. Min: 60, Max: 604800.
        /// </summary>
        [Input("validTime", required: true)]
        public Input<int> ValidTime { get; set; } = null!;

        public CcArgs()
        {
        }
        public static new CcArgs Empty => new CcArgs();
    }

    public sealed class CcState : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// Rule Action, 20 means observation, 21 means human-machine identification, 22 means interception, 23 means precise interception, 26 means precise human-machine identification, and 27 means JS verification.
        /// </summary>
        [Input("actionType")]
        public Input<string>? ActionType { get; set; }

        /// <summary>
        /// Advanced mode (whether to use session detection). 0(disabled) 1(enabled).
        /// </summary>
        [Input("advance")]
        public Input<string>? Advance { get; set; }

        /// <summary>
        /// Cel expression.
        /// </summary>
        [Input("celRule")]
        public Input<string>? CelRule { get; set; }

        /// <summary>
        /// Domain.
        /// </summary>
        [Input("domain")]
        public Input<string>? Domain { get; set; }

        /// <summary>
        /// WAF edition. clb-waf means clb-waf, sparta-waf means saas-waf.
        /// </summary>
        [Input("edition")]
        public Input<string>? Edition { get; set; }

        /// <summary>
        /// Event ID.
        /// </summary>
        [Input("eventId")]
        public Input<string>? EventId { get; set; }

        /// <summary>
        /// CC detection cycle.
        /// </summary>
        [Input("interval")]
        public Input<string>? Interval { get; set; }

        /// <summary>
        /// CC detection threshold.
        /// </summary>
        [Input("limit")]
        public Input<string>? Limit { get; set; }

        /// <summary>
        /// Frequency limiting method.
        /// </summary>
        [Input("limitMethod")]
        public Input<string>? LimitMethod { get; set; }

        /// <summary>
        /// Logical operator of configuration mode, and/or.
        /// </summary>
        [Input("logicalOp")]
        public Input<string>? LogicalOp { get; set; }

        /// <summary>
        /// Match method, 0(equal), 1(prefix), 2(contains), 3(not equal), 6(suffix), 7(not contains).
        /// </summary>
        [Input("matchFunc")]
        public Input<int>? MatchFunc { get; set; }

        /// <summary>
        /// Rule Name.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// CC matching conditions JSON serialized string, example: [{"key":"Method","args":["=R0VU"],"match":"0","encodeflag":true}] 
        /// 
        /// Available key values: Method, Post, Referer, Cookie, User-Agent, CustomHeader, CaptchaRisk, CaptchaDeviceRisk, CaptchaScore
        /// 
        /// Available match values:
        /// - When Key is Method: 0 (equal to), 3 (not equal to)
        /// - When Key is Post: 0 (equal to), 3 (not equal to)
        /// - When Key is Cookie: 0 (equal to), 2 (contains), 3 (not equal to), 7 (does not contain)
        /// - When Key is Referer: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is Cookie: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is User-Agent: 0 (equal to), 3 (not equal to), 1 (prefix match), 6 (suffix match), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is CustomHeader: 0 (equal to), 3 (not equal to), 2 (contains), 7 (does not contain), 12 (exists), 5 (does not exist), 4 (content is empty)
        /// - When Key is IPLocation: 13 (belongs to), 14 (does not belong to)
        /// - When Key is CaptchaRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaDeviceRisk: 0 (equal to), 3 (not equal to), 13 (belongs to), 14 (does not belong to), 12 (exists), 5 (does not exist)
        /// - When Key is CaptchaScore: 15 (numerically equal to), 16 (numerically not equal to), 17 (numerically greater than), 18 (numerically less than), 19 (numerically greater than or equal to), 20 (numerically less than or equal to), 12 (exists), 5 (does not exist)
        /// 
        /// The args parameter represents matching content and requires encodeflag to be set to true. When Key is Post, Cookie, or CustomHeader, use equals sign = to concatenate Key and Value separately, and encode both with Base64, similar to YWJj=YWJj. When Key is Referer or User-Agent, use equals sign = to concatenate Value, similar to =YWJj.
        /// </summary>
        [Input("optionsArr")]
        public Input<string>? OptionsArr { get; set; }

        /// <summary>
        /// Rule Priority.
        /// </summary>
        [Input("priority")]
        public Input<int>? Priority { get; set; }

        /// <summary>
        /// Rule ID.
        /// </summary>
        [Input("ruleId")]
        public Input<string>? RuleId { get; set; }

        [Input("sessionApplieds")]
        private InputList<int>? _sessionApplieds;

        /// <summary>
        /// Session ID that needs to be enabled for the rule.
        /// </summary>
        public InputList<int> SessionApplieds
        {
            get => _sessionApplieds ?? (_sessionApplieds = new InputList<int>());
            set => _sessionApplieds = value;
        }

        /// <summary>
        /// Rule Status, 0 rule close, 1 rule open.
        /// </summary>
        [Input("status")]
        public Input<int>? Status { get; set; }

        /// <summary>
        /// Operate Type.
        /// </summary>
        [Input("type")]
        public Input<int>? Type { get; set; }

        /// <summary>
        /// Detection URL.
        /// </summary>
        [Input("url")]
        public Input<string>? Url { get; set; }

        /// <summary>
        /// Action ValidTime, minute unit. Min: 60, Max: 604800.
        /// </summary>
        [Input("validTime")]
        public Input<int>? ValidTime { get; set; }

        public CcState()
        {
        }
        public static new CcState Empty => new CcState();
    }
}
